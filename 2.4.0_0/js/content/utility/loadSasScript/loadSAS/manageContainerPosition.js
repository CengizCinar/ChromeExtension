"use strict";import{mutableData}from"../../../constants/mutableData.js";import{positionConstants}from"../../../constants/positionConstants.js";import{loadSASPanelPosition}from"../../positionService/loadSASPanelPosition.js";import{showSasShortcuts}from"../../showSasShortcuts.js";import{setDockedState}from"./setDockedState.js";import{showSASPanel}from"../../toggleSASPanel/showSASPanel.js";import{setUrl}from"../../urlsService/setUrl.js";const manageContainerPosition=async()=>{const{FLOATING:o,AMAZON_EMBEDDED:a,AMAZON_EMBEDDED_WIDE:e,DEFAULT_FLOATING_WIDTH:t,DEFAULT_FLOATING_HEIGHT:n,DEFAULT_DOCKED_WIDTH:s,DEFAULT_DOCKED_STATE:i,DEFAULT_DOCKED_STATE_AMAZON:l}=positionConstants;chrome.storage.sync.get({display:!0,floatingWidth:t,floatingHeight:n,dockedWidth:s,dockedState:i,dockedStateAmazon:l,floatingLeft:0,floatingTop:0},function(t){mutableData.gFloatingTop=t.floatingTop,mutableData.gFloatingLeft=t.floatingLeft,mutableData.gFloatingHeight=t.floatingHeight,mutableData.gFloatingWidth=t.floatingWidth,mutableData.gDockedWidth=t.dockedWidth,mutableData.gAmazonProductPage?mutableData.gDockedState=t.dockedStateAmazon:(mutableData.gDockedState=t.dockedState,mutableData.gDockedState!=a&&mutableData.gDockedState!=e||(mutableData.gDockedState=i)),$("#SASContainer").draggable({handle:".first-row",containment:"window",iframeFix:!0,stop:function(t,a){$("#SASContainer").position().top<0&&$("#SASContainer").css({top:"0"}),mutableData.gFloatingLeft=$("#SASContainer").position().left,mutableData.gFloatingTop=$("#SASContainer").position().top,chrome.storage.sync.set({floatingLeft:mutableData.gFloatingLeft},function(){chrome.runtime.lastError&&console.error(chrome.runtime.lastError.message)}),chrome.storage.sync.set({floatingTop:mutableData.gFloatingTop},function(){chrome.runtime.lastError&&console.error(chrome.runtime.lastError.message)}),setDockedState(mutableData.gDockedState),loadSASPanelPosition()},drag:function(t,a){},start:function(t,a){mutableData.gDockedState==o&&(setDockedState(mutableData.gDockedState),loadSASPanelPosition())}}),$("#sasFrame").on("load",function(){$("#loadingMessage").css("display","none"),$("#sasFrame").css("display","block")}),mutableData.display=mutableData.display&&t.display,new URL(document.location).searchParams.has("sas_autoopen")&&(setUrl(""),mutableData.display=!0),1==mutableData.display&&showSASPanel(),showSasShortcuts(t.display)})};export{manageContainerPosition};